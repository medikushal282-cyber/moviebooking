<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theatres - BookYourShow</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #0a0a0f, #1a0b1f);
            color: #e6eef6;
            min-height: 100vh;
            font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        }

        .theatre-card {
            background: rgba(20, 20, 30, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .theatre-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border-color: rgba(207, 48, 170, 0.4);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, #a099d8, #cf30aa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .search-input {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            color: white;
            width: 100%;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #a099d8;
            background: rgba(255, 255, 255, 0.1);
        }
    </style>
</head>

<body>
    <custom-navbar></custom-navbar>
    <div class="h-20"></div>

    <main class="container mx-auto px-4 py-8">
        <div class="flex flex-col md:flex-row justify-between items-center mb-8">
            <h1 class="section-title mb-0">Our Theatres</h1>
            <div class="w-full md:w-1/3 mt-4 md:mt-0 relative">
                <input type="text" id="theatreSearch" placeholder="Search theatres..." class="search-input">
                <i data-feather="search" class="absolute right-3 top-3 text-gray-400 w-5 h-5"></i>
            </div>
        </div>

        <div id="loading" class="text-center py-12">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto"></div>
            <p class="mt-4 text-gray-400">Loading theatres...</p>
        </div>

        <div id="theatresGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 hidden">
            <!-- Theatres will be injected here -->
        </div>
    </main>

    <custom-footer></custom-footer>

    <script src="js/api.js"></script>
    <script src="components/navbar.js"></script>
    <script src="components/footer.js"></script>
    <script>
        if (window.feather) feather.replace();

        const theatresGrid = document.getElementById('theatresGrid');
        const loading = document.getElementById('loading');
        const searchInput = document.getElementById('theatreSearch');
        let allTheatres = [];

        async function init() {
            try {
                const response = await fetchTheatres();
                if (response.success) {
                    allTheatres = response.data;
                    renderTheatres(allTheatres);
                    loading.classList.add('hidden');
                    theatresGrid.classList.remove('hidden');
                } else {
                    showError('Failed to load theatres');
                }
            } catch (error) {
                console.error('Error:', error);
                showError(error.message);
            }
        }

        function renderTheatres(theatres) {
            theatresGrid.innerHTML = '';

            if (theatres.length === 0) {
                theatresGrid.innerHTML = `
                    <div class="col-span-full text-center py-12 text-gray-400">
                        <p class="text-xl">No theatres found matching your search.</p>
                    </div>
                `;
                return;
            }

            theatres.forEach(theatre => {
                const card = document.createElement('div');
                card.className = 'theatre-card';
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <h2 class="text-xl font-bold text-white">${theatre.name}</h2>
                        <span class="bg-gray-700 text-xs px-2 py-1 rounded text-gray-300">${theatre.screens} Screens</span>
                    </div>
                    
                    <div class="flex items-center text-gray-300 mb-2">
                        <i data-feather="map-pin" class="w-4 h-4 mr-2 text-primary-400"></i>
                        <span class="text-sm">${theatre.location}</span>
                    </div>

                    <div class="mt-6 pt-4 border-t border-gray-700 flex justify-between items-center">
                        <span class="text-xs text-gray-400">ID: ${theatre.screenId || 'N/A'}</span>
                        <a href="#" onclick="alert('Please select a movie first to book tickets at this theatre.')" class="text-sm font-semibold text-primary-400 hover:text-primary-300 transition-colors">View Shows â†’</a>
                    </div>
                `;
                theatresGrid.appendChild(card);
            });

            if (window.feather) feather.replace();
        }

        function showError(message) {
            loading.innerHTML = `
                <div class="text-red-500 text-xl">
                    <i data-feather="alert-circle" class="mx-auto mb-2 w-12 h-12"></i>
                    <p>${message}</p>
                    <button onclick="location.reload()" class="mt-4 px-4 py-2 bg-gray-800 rounded hover:bg-gray-700 transition">Try Again</button>
                </div>
            `;
            if (window.feather) feather.replace();
        }

        searchInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = allTheatres.filter(t =>
                t.name.toLowerCase().includes(term) ||
                t.location.toLowerCase().includes(term)
            );
            renderTheatres(filtered);
        });

        init();
    </script>
</body>

</html>